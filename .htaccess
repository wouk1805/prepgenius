# .htaccess
# URL Routing & Security

Options +FollowSymLinks -Indexes -MultiViews
DirectoryIndex index.php

RewriteEngine On
RewriteBase /projects/prepgenius/

# ============================================================================
# SECURITY: Block direct access to sensitive directories and files
# ============================================================================

# Block access to src/ directory (includes secrets.php, config.php, etc.)
RewriteRule ^src/ - [F,L]

# Block access to storage/ directory (shares are served via the API)
RewriteRule ^storage/ - [F,L]

# Block access to .htaccess files
RewriteRule \.htaccess$ - [F,L]

# ============================================================================
# PHP LIMITS (large payloads for long interviews & feedback)
# ============================================================================

php_value post_max_size 50M
php_value upload_max_filesize 20M
php_value max_execution_time 300
php_value memory_limit 256M

# ============================================================================
# API ROUTING
# ============================================================================

RewriteRule ^api/(.*)$ api/router.php [QSA,L]

# ============================================================================
# SHARE PAGE ROUTING
# ============================================================================

RewriteRule ^share/([a-z0-9]+)/?$ share.php [QSA,L]

# ============================================================================
# FRONTEND ROUTING
# ============================================================================

# Allow direct access to existing files and directories
RewriteCond %{REQUEST_FILENAME} -f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

# Route everything else to index.php (SPA)
RewriteRule ^ index.php [L]
